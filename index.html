<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Import American Cars Arica | El desierto merece su leyenda.</title>
    
    <!-- Meta tags SEO mejorados -->
    <meta name="description" content="Importamos los veh√≠culos americanos m√°s ic√≥nicos para que escribas tu propia historia en el desierto m√°s extenso del mundo.">
    <meta name="keywords" content="veh√≠culos americanos, importaci√≥n USA, Arica, kits upgrade, Ford, Chevrolet, RAM, 4x4, camionetas, pickup, SUV, deportivos">
    <meta name="author" content="Import American Cars Arica">
    <meta name="theme-color" content="#000000">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="format-detection" content="telephone=no">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://importamericancars.cl/">
    <meta property="og:title" content="Import American Cars Arica">
    <meta property="og:description" content="Importamos los veh√≠culos americanos m√°s ic√≥nicos para que escribas tu propia historia en el desierto m√°s extenso del mundo.">
    <meta property="og:image" content="https://res.cloudinary.com/df2gprqhp/image/upload/v1765988412/CHEVROLET_yjwbxt.jpg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://importamericancars.cl/">
    <meta property="twitter:title" content="Import American Cars Arica">
    <meta property="twitter:description" content="Importamos los veh√≠culos americanos m√°s ic√≥nicos para que escribas tu propia historia en el desierto m√°s extenso del mundo.">
    <meta property="twitter:image" content="https://res.cloudinary.com/df2gprqhp/image/upload/v1765988412/CHEVROLET_yjwbxt.jpg">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- CSS CENTRALIZADO -->
    <link rel="stylesheet" href="css/styles.css">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="apple-touch-icon" href="apple-touch-icon.png">
    
    <!-- Preload critical resources -->
    <link rel="preload" href="css/styles.css" as="style">
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="preconnect" href="https://res.cloudinary.com">
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "AutoDealer",
      "name": "Import American Cars Arica",
      "description": "Importaci√≥n de veh√≠culos americanos premium y kits de personalizaci√≥n.",
      "url": "https://importamericancars.cl",
      "logo": "https://importamericancars.cl/logo.png",
      "address": {
        "@type": "PostalAddress",
        "addressLocality": "Arica",
        "addressRegion": "Regi√≥n de Arica y Parinacota",
        "addressCountry": "CL"
      },
      "contactPoint": {
        "@type": "ContactPoint",
        "telephone": "+56-9-3865-4827",
        "contactType": "Customer Service",
        "areaServed": "CL",
        "availableLanguage": "Spanish"
      },
      "sameAs": [
        "https://www.instagram.com/import_american_cars"
      ]
    }
    </script>

    <!-- Supabase Client (ES Module) -->
    <script type="module">
        // Importar y configurar Supabase globalmente
        import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm';
        
        const supabaseUrl = 'https://cflpmluvhfldewiitymh.supabase.co';
        const supabaseKey = 'sb_publishable_lvUG-G_2bzDxyVZwAF25HA_30dFAb3K';
        
        // Crear cliente global
        window.supabase = createClient(supabaseUrl, supabaseKey);
        
        // Funci√≥n universal para leer la tabla vehiculos_arica
        window.leerTablaVehiculos = async function(consulta = '', limit = 100) {
            try {
                console.log('üîç Ejecutando consulta Supabase...');
                
                let query = window.supabase
                    .from('vehiculos_arica')
                    .select('*');
                
                if (consulta && consulta.trim() !== '') {
                    query = query.or(consulta);
                }
                
                const { data, error } = await query
                    .order('orden', { ascending: true })
                    .limit(limit);
                
                if (error) {
                    console.error('‚ùå Error Supabase:', error);
                    return { 
                        success: false, 
                        error: error.message,
                        data: []
                    };
                }
                
                console.log(`‚úÖ ${data.length} veh√≠culos obtenidos de vehiculos_arica`);
                return { 
                    success: true, 
                    data: data,
                    count: data.length,
                    timestamp: new Date().toISOString()
                };
                
            } catch (error) {
                console.error('‚ùå Error en leerTablaVehiculos:', error);
                return { 
                    success: false, 
                    error: error.message,
                    data: []
                };
            }
        };

        // Funci√≥n para analizar datos de la tabla
        window.analizarVehiculos = async function() {
            try {
                const { data, error } = await window.supabase
                    .from('vehiculos_arica')
                    .select('*');
                
                if (error) throw error;
                
                // An√°lisis b√°sico
                const total = data.length;
                const marcas = [...new Set(data.map(v => v.marca).filter(Boolean))];
                const estados = [...new Set(data.map(v => v.estado || 'stock').filter(Boolean))];
                
                // Conteo por estado
                const conteoEstados = {};
                estados.forEach(estado => {
                    conteoEstados[estado] = data.filter(v => (v.estado || 'stock') === estado).length;
                });
                
                // Rango de precios
                const precios = data.map(v => v.precio || 0).filter(p => p > 0);
                const precioMin = precios.length > 0 ? Math.min(...precios) : 0;
                const precioMax = precios.length > 0 ? Math.max(...precios) : 0;
                
                return {
                    total: total,
                    marcas: marcas,
                    estados: estados,
                    conteoEstados: conteoEstados,
                    precioMin: precioMin,
                    precioMax: precioMax,
                    precioPromedio: precios.length > 0 ? Math.round(precios.reduce((a, b) => a + b, 0) / precios.length) : 0,
                    ultimaActualizacion: new Date().toISOString()
                };
                
            } catch (error) {
                console.error('‚ùå Error analizando veh√≠culos:', error);
                return null;
            }
        };

        // Funci√≥n de prueba r√°pida
        window.testSupabaseConnection = async function() {
            console.log('üß™ Probando conexi√≥n a Supabase...');
            
            try {
                const { data, error } = await window.supabase
                    .from('vehiculos_arica')
                    .select('id, nombre, marca, precio')
                    .limit(3);
                
                if (error) {
                    console.error('‚ùå Error de conexi√≥n:', error);
                    return false;
                }
                
                console.log('‚úÖ Conexi√≥n exitosa! Datos de muestra:', data);
                return true;
                
            } catch (error) {
                console.error('‚ùå Error de conexi√≥n:', error);
                return false;
            }
        };

        // Ejecutar prueba autom√°tica al cargar
        setTimeout(() => {
            window.testSupabaseConnection();
        }, 1000);

        console.log('üöÄ Supabase Client configurado correctamente');
    </script>
</head>
<body>
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="loading-spinner">
                <i class="fas fa-car"></i>
            </div>
            <p class="loading-text">Cargando...</p>
        </div>
    </div>

    <!-- Header -->
    <header class="header" id="mainHeader">
        <div class="header-container">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-car"></i>
                </div>
                <span class="logo-text">Import American Cars Arica</span>
            </div>
            <nav class="nav" aria-label="Navegaci√≥n principal">
                <ul class="nav-links">
                    <li><a href="#vehicles" class="nav-link" data-scroll="vehicles">Veh√≠culos</a></li>
                    <li><a href="#customize" class="nav-link" data-scroll="customize">Kits Upgrade</a></li>
                    <li><a href="#instagram" class="nav-link" data-scroll="instagram">Instagram</a></li>
                    <li><a href="#contact" class="nav-link" data-scroll="contact">Contacto</a></li>
                </ul>
            </nav>
            <button class="menu-toggle" id="menuToggle" aria-label="Men√∫" aria-expanded="false" aria-controls="mobileMenu">
                <i class="fas fa-bars"></i>
            </button>
        </div>
    </header>

    <!-- Mobile Menu -->
    <div class="mobile-menu" id="mobileMenu" aria-hidden="true">
        <a href="#vehicles" class="mobile-nav-link" data-scroll="vehicles">
            <i class="fas fa-car"></i> Veh√≠culos
        </a>
        <a href="#customize" class="mobile-nav-link" data-scroll="customize">
            <i class="fas fa-cog"></i> Kits Upgrade
        </a>
        <a href="#instagram" class="mobile-nav-link" data-scroll="instagram">
            <i class="fab fa-instagram"></i> Instagram
        </a>
        <a href="#contact" class="mobile-nav-link" data-scroll="contact">
            <i class="fas fa-envelope"></i> Contacto
        </a>
        <div class="mobile-menu-footer">
            <a href="https://wa.me/56938654827" target="_blank" class="button button-small button-whatsapp">
                <i class="fab fa-whatsapp"></i> WhatsApp
            </a>
        </div>
    </div>

    <!-- Hero Section -->
    <section class="hero" id="hero">
        <div class="hero-content">
            <h1 class="hero-title">
                <span class="hero-main">IAC ARICA</span>
                <span class="hero-tagline">El desierto merece su leyenda.</span>
            </h1>
            
            <p class="hero-subtitle">
                Llevamos los veh√≠culos m√°s ic√≥nicos y sus exclusivos kits de personalizaci√≥n al desierto m√°s extenso del mundo.
            </p>
            
            <!-- Indicadores -->
            <div class="stock-indicators">
                <div class="indicator" data-filter="stock" role="button" tabindex="0" aria-label="Ver veh√≠culos en stock">
                    <div class="indicator-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="indicator-content">
                        <div class="indicator-number" id="stockCount">0</div>
                        <div class="indicator-label">En Stock Arica</div>
                    </div>
                </div>
                
                <div class="indicator" data-filter="transit" role="button" tabindex="0" aria-label="Ver veh√≠culos en tr√°nsito">
                    <div class="indicator-icon">
                        <i class="fas fa-shipping-fast"></i>
                    </div>
                    <div class="indicator-content">
                        <div class="indicator-number" id="transitCount">0</div>
                        <div class="indicator-label">En Tr√°nsito</div>
                    </div>
                </div>
                
                <div class="indicator" data-filter="reserved" role="button" tabindex="0" aria-label="Ver veh√≠culos para reservar">
                    <div class="indicator-icon">
                        <i class="fas fa-calendar-check"></i>
                    </div>
                    <div class="indicator-content">
                        <div class="indicator-number" id="reservedCount">0</div>
                        <div class="indicator-label">Para Reservar</div>
                    </div>
                </div>
                
                <div class="indicator" data-filter="all" role="button" tabindex="0" aria-label="Ver todos los veh√≠culos">
                    <div class="indicator-icon">
                        <i class="fas fa-car"></i>
                    </div>
                    <div class="indicator-content">
                        <div class="indicator-number" id="totalCount">0</div>
                        <div class="indicator-label">Total Veh√≠culos</div>
                    </div>
                </div>
            </div>
            
            <!-- Call to Action -->
            <div class="hero-cta">
                <a href="#vehicles" class="btn-apple" data-scroll="vehicles">
                    <i class="fas fa-chevron-down"></i>
                    Ver Cat√°logo Completo
                </a>
                <a href="https://wa.me/56938654827" target="_blank" class="btn-apple btn-whatsapp">
                    <i class="fab fa-whatsapp"></i>
                    Contactar por WhatsApp
                </a>
            </div>
        </div>
        
        <!-- Flecha explorar -->
        <div class="explore-arrow" onclick="scrollToSection('vehicles')" role="button" tabindex="0" aria-label="Desplazarse a la secci√≥n de veh√≠culos">
            <i class="fas fa-chevron-down"></i>
        </div>
    </section>

    <!-- Vehicles Section -->
    <section class="section vehicles-section" id="vehicles">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Veh√≠culos Disponibles</h2>
                <p class="section-subtitle">Selecci√≥n premium de veh√≠culos americanos importados directamente desde USA</p>
            </div>
            
            <div class="filter-controls">
                <div class="filter-buttons">
                    <button class="filter-button active" data-filter="all" aria-pressed="true">
                        Todos <span id="filterCount" class="filter-count">(0)</span>
                    </button>
                    <button class="filter-button" data-filter="stock" aria-pressed="false">
                        <i class="fas fa-check-circle"></i> Stock Arica
                    </button>
                    <button class="filter-button" data-filter="transit" aria-pressed="false">
                        <i class="fas fa-shipping-fast"></i> En Tr√°nsito
                    </button>
                    <button class="filter-button" data-filter="reserved" aria-pressed="false">
                        <i class="fas fa-calendar-check"></i> Para Reservar
                    </button>
                </div>
                
                <div class="filter-advanced" id="advancedFilters" style="display: none;">
                    <div class="filter-row">
                        <div class="filter-group">
                            <label for="filterMarca" class="filter-label">Marca:</label>
                            <select id="filterMarca" class="form-control">
                                <option value="">Todas las marcas</option>
                                <!-- Se llenar√° din√°micamente -->
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="filterPrecioMin" class="filter-label">Precio m√≠nimo:</label>
                            <input type="number" id="filterPrecioMin" class="form-control" placeholder="$">
                        </div>
                        <div class="filter-group">
                            <label for="filterPrecioMax" class="filter-label">Precio m√°ximo:</label>
                            <input type="number" id="filterPrecioMax" class="form-control" placeholder="$">
                        </div>
                    </div>
                    <div class="filter-actions">
                        <button class="button button-small" id="applyFilters">
                            <i class="fas fa-filter"></i> Aplicar Filtros
                        </button>
                        <button class="button button-small button-outline" id="clearFilters">
                            <i class="fas fa-times"></i> Limpiar
                        </button>
                    </div>
                </div>
                
                <button class="button button-small button-outline" id="toggleFilters">
                    <i class="fas fa-sliders-h"></i> M√°s filtros
                </button>
            </div>
            
            <div class="vehicles-grid" id="vehiclesContainer">
                <!-- Se cargar√° din√°micamente -->
                <div class="loading-placeholder">
                    <div class="loading-spinner"><i class="fas fa-spinner fa-spin"></i></div>
                    <p>Cargando veh√≠culos...</p>
                </div>
            </div>
            
            <div class="section-footer" id="vehiclesFooter" style="display: none;">
                <p class="text-center">
                    <i class="fas fa-info-circle"></i>
                    Mostrando <span id="vehiclesShown">0</span> de <span id="vehiclesTotal">0</span> veh√≠culos
                </p>
                <div class="text-center mt-3">
                    <button class="button button-outline" id="loadMoreVehicles">
                        <i class="fas fa-plus"></i> Cargar m√°s veh√≠culos
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Kits Section -->
    <section class="section kits-section" id="customize">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Kits Upgrade Personalizados</h2>
                <p class="section-subtitle">Cada veh√≠culo tiene kits de upgrade con precios espec√≠ficos seg√∫n modelo y caracter√≠sticas.</p>
            </div>
            
            <div class="kits-grid" id="kitsContainer">
                <!-- Se cargar√° din√°micamente -->
                <div class="kit-card">
                    <div class="kit-icon">
                        <i class="fas fa-star"></i>
                    </div>
                    <h3 class="kit-title">Standard</h3>
                    <p class="kit-description">Preparaci√≥n b√°sica incluida con cada veh√≠culo</p>
                    <div class="kit-price">INCLUIDO</div>
                    <ul class="kit-features">
                        <li><i class="fas fa-check"></i> Limpieza completa</li>
                        <li><i class="fas fa-check"></i> Revisi√≥n mec√°nica</li>
                        <li><i class="fas fa-check"></i> Documentaci√≥n en regla</li>
                        <li><i class="fas fa-check"></i> Garant√≠a 30 d√≠as</li>
                    </ul>
                </div>
                
                <div class="kit-card featured">
                    <div class="kit-icon">
                        <i class="fas fa-medal"></i>
                    </div>
                    <h3 class="kit-title">Medium</h3>
                    <p class="kit-description">Mejoras est√©ticas y funcionales avanzadas</p>
                    <div class="kit-price">DESDE $1.2M</div>
                    <ul class="kit-features">
                        <li><i class="fas fa-check"></i> Todo lo del Kit Standard</li>
                        <li><i class="fas fa-check"></i> Llantas deportivas 20"</li>
                        <li><i class="fas fa-check"></i> Tratamiento cer√°mico</li>
                        <li><i class="fas fa-check"></i> Audio premium</li>
                        <li><i class="fas fa-check"></i> Asistencia 6 meses</li>
                    </ul>
                </div>
                
                <div class="kit-card">
                    <div class="kit-icon">
                        <i class="fas fa-crown"></i>
                    </div>
                    <h3 class="kit-title">Full</h3>
                    <p class="kit-description">Transformaci√≥n premium completa</p>
                    <div class="kit-price">DESDE $2.5M</div>
                    <ul class="kit-features">
                        <li><i class="fas fa-check"></i> Todo lo del Kit Medium</li>
                        <li><i class="fas fa-check"></i> Suspensi√≥n deportiva</li>
                        <li><i class="fas fa-check"></i> Kit de carrocer√≠a</li>
                        <li><i class="fas fa-check"></i> Interior cuero premium</li>
                        <li><i class="fas fa-check"></i> Asistencia 12 meses</li>
                    </ul>
                </div>
            </div>
            
            <p class="kit-disclaimer">
                <i class="fas fa-exclamation-circle"></i>
                Los kits var√≠an seg√∫n el modelo del veh√≠culo. Puedes personalizar y cotizar el kit exacto al seleccionar un veh√≠culo espec√≠fico.
                Los precios son referenciales y sujetos a confirmaci√≥n.
            </p>
            
            <div class="text-center">
                <button class="button button-large" id="showAllKits">
                    <i class="fas fa-cog"></i> Ver Kits Personalizados por Veh√≠culo
                </button>
                <p class="mt-2 text-sm text-gray-600">
                    Selecciona un veh√≠culo primero para ver los kits disponibles espec√≠ficos
                </p>
            </div>
        </div>
    </section>

    <!-- Instagram Section -->
    <section class="section instagram-section" id="instagram">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">En Instagram</h2>
                <p class="section-subtitle">Sigue nuestro proceso de importaci√≥n, veh√≠culos en stock y transformaciones con kits upgrade</p>
            </div>
            
            <div class="instagram-feed" id="instagramFeed">
                <!-- Placeholder para posts de Instagram -->
                <div class="instagram-post">
                    <div class="instagram-image-placeholder">
                        <i class="fab fa-instagram"></i>
                    </div>
                    <div class="instagram-info">
                        <div class="instagram-stats">
                            <span class="instagram-stat">
                                <i class="fas fa-heart"></i> 245
                            </span>
                            <span class="instagram-stat">
                                <i class="fas fa-comment"></i> 32
                            </span>
                        </div>
                        <p class="instagram-caption">
                            √öltima importaci√≥n: Ford F-150 Raptor lista para entrega.
                            Kit Full Upgrade aplicado.
                        </p>
                        <div class="instagram-hashtags">
                            #ImportAmericanCars #FordRaptor #KitFull
                        </div>
                    </div>
                </div>
                
                <div class="instagram-post">
                    <div class="instagram-image-placeholder">
                        <i class="fab fa-instagram"></i>
                    </div>
                    <div class="instagram-info">
                        <div class="instagram-stats">
                            <span class="instagram-stat">
                                <i class="fas fa-heart"></i> 189
                            </span>
                            <span class="instagram-stat">
                                <i class="fas fa-comment"></i> 24
                            </span>
                        </div>
                        <p class="instagram-caption">
                            Chevrolet Silverado 2023 en proceso de preparaci√≥n.
                            Kit Medium aplicado con llantas nuevas.
                        </p>
                        <div class="instagram-hashtags">
                            #Chevrolet #Silverado #KitMedium
                        </div>
                    </div>
                </div>
                
                <div class="instagram-post">
                    <div class="instagram-image-placeholder">
                        <i class="fab fa-instagram"></i>
                    </div>
                    <div class="instagram-info">
                        <div class="instagram-stats">
                            <span class="instagram-stat">
                                <i class="fas fa-heart"></i> 312
                            </span>
                            <span class="instagram-stat">
                                <i class="fas fa-comment"></i> 45
                            </span>
                        </div>
                        <p class="instagram-caption">
                            RAM 1500 Limited lista para el desierto.
                            Transformaci√≥n completa con todos los upgrades.
                        </p>
                        <div class="instagram-hashtags">
                            #RAM1500 #DesiertoArica #OffRoad
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="instagram-cta">
                <a href="https://www.instagram.com/import_american_cars" target="_blank" class="button button-instagram button-large">
                    <i class="fab fa-instagram"></i> Seguir en Instagram: @import_american_cars
                </a>
                <p class="instagram-hashtags">
                    #ImportAmericanCarsArica ‚Ä¢ #Veh√≠culosUSA ‚Ä¢ #KitsUpgrade ‚Ä¢ #Arica ‚Ä¢ #Desierto
                </p>
            </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section class="section contact-section" id="contact">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Contacto</h2>
                <p class="section-subtitle">Cont√°ctanos para encontrar el veh√≠culo americano de tus sue√±os</p>
            </div>
            
            <div class="contact-buttons">
                <a href="https://wa.me/56938654827" target="_blank" class="button button-whatsapp button-large">
                    <i class="fab fa-whatsapp"></i> WhatsApp
                </a>
                <a href="https://www.instagram.com/import_american_cars" target="_blank" class="button button-outline button-large">
                    <i class="fab fa-instagram"></i> Instagram
                </a>
                <a href="mailto:contacto@importamericancars.cl" class="button button-outline button-large">
                    <i class="fas fa-envelope"></i> Email
                </a>
            </div>
            
            <div class="contact-info">
                <p><i class="fas fa-map-marker-alt"></i> Zona Franca Arica, Chile</p>
                <p><i class="fas fa-phone-alt"></i> +56 9 3865 4827</p>
                <p><i class="fas fa-clock"></i> Lunes a Viernes 9:00 - 19:00</p>
                <p><i class="fas fa-envelope"></i> contacto@importamericancars.cl</p>
            </div>
            
            <div class="contact-map" id="contactMap">
                <!-- Mapa placeholder -->
                <div class="map-placeholder">
                    <i class="fas fa-map-marked-alt"></i>
                    <p>Zona Franca Arica, Regi√≥n de Arica y Parinacota</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-logo">
                <div class="logo">
                    <span class="logo-text">Import American Cars Arica</span>
                </div>
                <span class="footer-tagline">El desierto merece su leyenda.</span>
            </div>
            
            <div class="footer-info">
                <p><i class="fas fa-car"></i> Importamos los veh√≠culos americanos m√°s ic√≥nicos</p>
                <p><i class="fas fa-map-marker-alt"></i> Arica, Chile</p>
                <p><i class="fas fa-phone"></i> +56 9 3865 4827</p>
                <p><i class="fas fa-envelope"></i> contacto@importamericancars.cl</p>
            </div>
            
            <div class="footer-links">
                <a href="#vehicles" class="footer-link">Veh√≠culos</a>
                <a href="#customize" class="footer-link">Kits Upgrade</a>
                <a href="#instagram" class="footer-link">Instagram</a>
                <a href="#contact" class="footer-link">Contacto</a>
                <a href="#" class="footer-link" id="privacyPolicy">Pol√≠tica de Privacidad</a>
                <a href="#" class="footer-link" id="termsService">T√©rminos de Servicio</a>
            </div>
            
            <div class="footer-social">
                <a href="https://wa.me/56938654827" target="_blank" class="social-icon social-whatsapp" aria-label="WhatsApp">
                    <i class="fab fa-whatsapp"></i>
                </a>
                <a href="https://www.instagram.com/import_american_cars" target="_blank" class="social-icon social-instagram" aria-label="Instagram">
                    <i class="fab fa-instagram"></i>
                </a>
                <a href="mailto:contacto@importamericancars.cl" class="social-icon social-email" aria-label="Email">
                    <i class="fas fa-envelope"></i>
                </a>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; <span id="currentYear">2025</span> Import American Cars Arica. Todos los derechos reservados.</p>
                <p class="footer-version">v2.0.0</p>
            </div>
        </div>
    </footer>

    <!-- Modales -->
    <div class="modal" id="vehicleModal" role="dialog" aria-modal="true" aria-labelledby="vehicleModalTitle" aria-hidden="true">
        <div class="modal-content">
            <button class="close-modal" id="closeVehicleModal" aria-label="Cerrar modal">√ó</button>
            <div class="modal-header">
                <h2 id="vehicleModalTitle">Detalles del Veh√≠culo</h2>
            </div>
            <div class="modal-body" id="vehicleModalContent">
                <!-- Contenido din√°mico -->
            </div>
        </div>
    </div>

    <div class="modal" id="customizationModal" role="dialog" aria-modal="true" aria-labelledby="customizationModalTitle" aria-hidden="true">
        <div class="modal-content">
            <button class="close-modal" id="closeCustomizationModal" aria-label="Cerrar modal">√ó</button>
            <div class="modal-header">
                <h2 id="customizationModalTitle">Personalizaci√≥n</h2>
            </div>
            <div class="modal-body" id="customizationContent">
                <!-- Contenido din√°mico -->
            </div>
        </div>
    </div>

    <!-- Notifications Container -->
    <div id="notificationContainer" aria-live="polite" aria-atomic="true"></div>

    <!-- JavaScript -->
    <script type="module">
        // Configuraci√≥n global
        import { CONFIG } from './config.js';
        import { UIManager } from './ui-manager.js';
        import { ProductosManager } from './productos-manager.js';
        
        // Variables globales
        let productosManager;
        let currentPage = 1;
        const vehiclesPerPage = 12;
        
        // Inicializar aplicaci√≥n
        document.addEventListener('DOMContentLoaded', async () => {
            console.log('üöÄ Iniciando aplicaci√≥n...');
            
            // Ocultar loading overlay
            setTimeout(() => {
                const loadingOverlay = document.getElementById('loadingOverlay');
                if (loadingOverlay) {
                    loadingOverlay.classList.add('fade-out');
                    setTimeout(() => loadingOverlay.remove(), 500);
                }
            }, 1000);
            
            try {
                // Primero, probar conexi√≥n directa a Supabase
                console.log('üîç Probando conexi√≥n a Supabase...');
                const conexionOk = await window.testSupabaseConnection();
                
                if (!conexionOk) {
                    console.warn('‚ö†Ô∏è Sin conexi√≥n a Supabase. Usando datos locales.');
                    window.UINotifications?.warning('Modo offline activado', 3000);
                }
                
                // Inicializar UI Manager
                await UIManager.init({
                    autoInitSlider: true
                });
                
                // Inicializar Productos Manager
                productosManager = new ProductosManager(CONFIG);
                window.productosManager = productosManager;
                
                // Configurar a√±o actual
                document.getElementById('currentYear').textContent = new Date().getFullYear();
                
                // Configurar eventos
                setupEventListeners();
                
                // Cargar datos iniciales
                await loadInitialData();
                
                // Inicializar scroll suave
                initSmoothScroll();
                
                // Inicializar b√∫squeda y filtros
                initSearchAndFilters();
                
                console.log('‚úÖ Aplicaci√≥n inicializada correctamente');
                
                // Seguimiento de p√°gina
                UIManager.trackPageView('home');
                
                // Mostrar datos de prueba en consola
                mostrarDatosConsola();
                
            } catch (error) {
                console.error('‚ùå Error inicializando aplicaci√≥n:', error);
                UINotifications.error('Error al inicializar la aplicaci√≥n');
            }
        });
        
        // Configurar event listeners
        function setupEventListeners() {
            // Men√∫ m√≥vil
            document.getElementById('menuToggle')?.addEventListener('click', toggleMobileMenu);
            
            // Filtros
            document.querySelectorAll('.filter-button').forEach(btn => {
                btn.addEventListener('click', handleFilterClick);
            });
            
            // Indicadores del hero
            document.querySelectorAll('.indicator').forEach(indicator => {
                indicator.addEventListener('click', handleIndicatorClick);
                indicator.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        handleIndicatorClick(e);
                    }
                });
            });
            
            // Bot√≥n mostrar todos los kits
            document.getElementById('showAllKits')?.addEventListener('click', handleShowAllKits);
            
            // Bot√≥n m√°s filtros
            document.getElementById('toggleFilters')?.addEventListener('click', toggleAdvancedFilters);
            
            // Aplicar filtros avanzados
            document.getElementById('applyFilters')?.addEventListener('click', applyAdvancedFilters);
            document.getElementById('clearFilters')?.addEventListener('click', clearAdvancedFilters);
            
            // Bot√≥n cargar m√°s veh√≠culos
            document.getElementById('loadMoreVehicles')?.addEventListener('click', loadMoreVehicles);
            
            // Pol√≠ticas y t√©rminos
            document.getElementById('privacyPolicy')?.addEventListener('click', showPrivacyPolicy);
            document.getElementById('termsService')?.addEventListener('click', showTermsOfService);
            
            // Enlaces de scroll suave
            document.querySelectorAll('[data-scroll]').forEach(link => {
                link.addEventListener('click', handleSmoothScroll);
            });
            
            // Bot√≥n de prueba Supabase (debug)
            document.addEventListener('keydown', (e) => {
                // Ctrl+Shift+S para probar Supabase
                if (e.ctrlKey && e.shiftKey && e.key === 'S') {
                    e.preventDefault();
                    testSupabaseManual();
                }
            });
            
            // Recargar datos peri√≥dicamente (cada 5 minutos)
            setInterval(() => {
                productosManager?.refreshData();
            }, 5 * 60 * 1000);
            
            // Detectar cambios en conexi√≥n
            window.addEventListener('online', handleOnlineStatus);
            window.addEventListener('offline', handleOfflineStatus);
        }
        
        // Cargar datos iniciales
        async function loadInitialData() {
            try {
                // Cargar veh√≠culos
                await productosManager.cargarVehiculos();
                
                // Cargar marcas para filtros
                loadBrandsFilter();
                
                // Actualizar UI
                updateVehiclesCount();
                
                // Actualizar estad√≠sticas del hero
                updateHeroStats();
                
            } catch (error) {
                console.error('‚ùå Error cargando datos iniciales:', error);
            }
        }
        
        // Actualizar estad√≠sticas del hero
        async function updateHeroStats() {
            try {
                const analisis = await window.analizarVehiculos();
                if (analisis) {
                    document.getElementById('stockCount').textContent = analisis.conteoEstados?.stock || 0;
                    document.getElementById('transitCount').textContent = analisis.conteoEstados?.transit || 0;
                    document.getElementById('reservedCount').textContent = analisis.conteoEstados?.reserved || 0;
                    document.getElementById('totalCount').textContent = analisis.total || 0;
                    
                    console.log('üìä Estad√≠sticas actualizadas:', analisis);
                }
            } catch (error) {
                console.error('‚ùå Error actualizando estad√≠sticas:', error);
            }
        }
        
        // Manejar clicks en filtros
        function handleFilterClick(e) {
            const filter = e.currentTarget.dataset.filter;
            if (filter && productosManager) {
                productosManager.filtrarVehiculos(filter);
                
                // Scroll a la secci√≥n de veh√≠culos
                scrollToSection('vehicles');
            }
        }
        
        // Manejar clicks en indicadores
        function handleIndicatorClick(e) {
            const filter = e.currentTarget.dataset.filter;
            if (filter && productosManager) {
                productosManager.filtrarVehiculos(filter);
                scrollToSection('vehicles');
            }
        }
        
        // Manejar mostrar todos los kits
        function handleShowAllKits() {
            const firstVehicle = productosManager?.vehiculos[0];
            if (firstVehicle) {
                UIManager.customizeVehicle(firstVehicle.id);
            } else {
                UINotifications.info('Primero carga los veh√≠culos para ver los kits disponibles');
            }
        }
        
        // Toggle men√∫ m√≥vil
        function toggleMobileMenu() {
            const mobileMenu = document.getElementById('mobileMenu');
            const menuToggle = document.getElementById('menuToggle');
            
            if (mobileMenu && menuToggle) {
                const isExpanded = menuToggle.getAttribute('aria-expanded') === 'true';
                
                mobileMenu.classList.toggle('active');
                menuToggle.classList.toggle('active');
                menuToggle.setAttribute('aria-expanded', !isExpanded);
                mobileMenu.setAttribute('aria-hidden', isExpanded);
                
                // Cambiar icono
                const icon = menuToggle.querySelector('i');
                if (icon) {
                    icon.className = isExpanded ? 'fas fa-bars' : 'fas fa-times';
                }
            }
        }
        
        // Inicializar scroll suave
        function initSmoothScroll() {
            // Configurar offset para header fijo
            const headerHeight = document.querySelector('.header')?.offsetHeight || 80;
            
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function(e) {
                    const targetId = this.getAttribute('href');
                    if (targetId === '#') return;
                    
                    const targetElement = document.querySelector(targetId);
                    if (targetElement) {
                        e.preventDefault();
                        
                        const targetPosition = targetElement.offsetTop - headerHeight;
                        window.scrollTo({
                            top: targetPosition,
                            behavior: 'smooth'
                        });
                        
                        // Cerrar men√∫ m√≥vil si est√° abierto
                        const mobileMenu = document.getElementById('mobileMenu');
                        if (mobileMenu?.classList.contains('active')) {
                            toggleMobileMenu();
                        }
                    }
                });
            });
        }
        
        // Manejar scroll suave para enlaces con data-scroll
        function handleSmoothScroll(e) {
            e.preventDefault();
            const targetId = this.getAttribute('href');
            scrollToSection(targetId.replace('#', ''));
            
            // Cerrar men√∫ m√≥vil si est√° abierto
            const mobileMenu = document.getElementById('mobileMenu');
            if (mobileMenu?.classList.contains('active')) {
                toggleMobileMenu();
            }
        }
        
        // Funci√≥n helper para scroll a secci√≥n
        function scrollToSection(sectionId) {
            const section = document.getElementById(sectionId);
            if (section) {
                const headerHeight = document.querySelector('.header')?.offsetHeight || 80;
                const sectionPosition = section.offsetTop - headerHeight;
                
                window.scrollTo({
                    top: sectionPosition,
                    behavior: 'smooth'
                });
            }
        }
        
        // Inicializar b√∫squeda y filtros
        function initSearchAndFilters() {
            // B√∫squeda en tiempo real (con debounce)
            let searchTimeout;
            const searchInput = document.getElementById('searchInput');
            
            if (searchInput) {
                searchInput.addEventListener('input', (e) => {
                    clearTimeout(searchTimeout);
                    searchTimeout = setTimeout(() => {
                        const query = e.target.value.trim();
                        if (query.length >= 2 || query.length === 0) {
                            productosManager?.buscarVehiculos(query);
                        }
                    }, 300);
                });
            }
        }
        
        // Toggle filtros avanzados
        function toggleAdvancedFilters() {
            const advancedFilters = document.getElementById('advancedFilters');
            const toggleButton = document.getElementById('toggleFilters');
            
            if (advancedFilters && toggleButton) {
                const isVisible = advancedFilters.style.display !== 'none';
                
                advancedFilters.style.display = isVisible ? 'none' : 'block';
                toggleButton.innerHTML = isVisible ? 
                    '<i class="fas fa-sliders-h"></i> M√°s filtros' : 
                    '<i class="fas fa-times"></i> Menos filtros';
                
                // Ajustar aria-expanded
                toggleButton.setAttribute('aria-expanded', !isVisible);
            }
        }
        
        // Aplicar filtros avanzados
        function applyAdvancedFilters() {
            const marca = document.getElementById('filterMarca')?.value;
            const precioMin = document.getElementById('filterPrecioMin')?.value;
            const precioMax = document.getElementById('filterPrecioMax')?.value;
            
            const filters = {};
            
            if (marca) filters.marca = marca;
            if (precioMin) filters.minPrecio = parseInt(precioMin);
            if (precioMax) filters.maxPrecio = parseInt(precioMax);
            
            if (Object.keys(filters).length > 0) {
                productosManager?.aplicarFiltros(filters);
            }
        }
        
        // Limpiar filtros avanzados
        function clearAdvancedFilters() {
            document.getElementById('filterMarca').value = '';
            document.getElementById('filterPrecioMin').value = '';
            document.getElementById('filterPrecioMax').value = '';
            
            productosManager?.aplicarFiltros({
                marca: null,
                minPrecio: null,
                maxPrecio: null
            });
        }
        
        // Cargar marcas en filtro
        function loadBrandsFilter() {
            const select = document.getElementById('filterMarca');
            if (!select || !productosManager) return;
            
            const marcas = productosManager.getMarcasDisponibles();
            
            // Limpiar opciones excepto la primera
            while (select.options.length > 1) {
                select.remove(1);
            }
            
            // Agregar marcas
            marcas.forEach(marca => {
                const option = document.createElement('option');
                option.value = marca;
                option.textContent = marca;
                select.appendChild(option);
            });
        }
        
        // Cargar m√°s veh√≠culos (paginaci√≥n)
        function loadMoreVehicles() {
            currentPage++;
            updateVehiclesCount();
            // Aqu√≠ ir√≠a la l√≥gica de paginaci√≥n si se implementa
        }
        
        // Actualizar contadores de veh√≠culos
        function updateVehiclesCount() {
            const vehiclesShown = document.getElementById('vehiclesShown');
            const vehiclesTotal = document.getElementById('vehiclesTotal');
            const vehiclesFooter = document.getElementById('vehiclesFooter');
            
            if (vehiclesShown && vehiclesTotal && productosManager) {
                const filteredCount = productosManager.getVehiculosFiltrados().length;
                const totalCount = productosManager.vehiculos.length;
                
                vehiclesShown.textContent = filteredCount;
                vehiclesTotal.textContent = totalCount;
                
                // Mostrar footer solo si hay m√°s veh√≠culos
                if (vehiclesFooter) {
                    vehiclesFooter.style.display = 'block';
                }
            }
        }
        
        // Mostrar pol√≠tica de privacidad
        function showPrivacyPolicy(e) {
            e.preventDefault();
            UINotifications.info('Pol√≠tica de privacidad - En desarrollo', 3000);
            // Aqu√≠ se abrir√≠a un modal con la pol√≠tica
        }
        
        // Mostrar t√©rminos de servicio
        function showTermsOfService(e) {
            e.preventDefault();
            UINotifications.info('T√©rminos de servicio - En desarrollo', 3000);
            // Aqu√≠ se abrir√≠a un modal con los t√©rminos
        }
        
        // Manejar cambio a online
        function handleOnlineStatus() {
            UINotifications.success('Conectado a internet', 2000);
            
            // Recargar datos si es necesario
            const lastUpdate = productosManager?.getUltimaActualizacion();
            if (lastUpdate && Date.now() - lastUpdate.timestamp > 5 * 60 * 1000) {
                productosManager?.refreshData();
            }
        }
        
        // Manejar cambio a offline
        function handleOfflineStatus() {
            UINotifications.warning('Sin conexi√≥n a internet', 5000);
        }
        
        // Funci√≥n de prueba manual de Supabase
        async function testSupabaseManual() {
            console.log('üß™ Prueba manual de Supabase iniciada...');
            
            try {
                const resultado = await window.leerTablaVehiculos('', 5);
                
                if (resultado.success) {
                    console.log('‚úÖ Test exitoso! Datos obtenidos:', resultado.data);
                    UINotifications.success(`Conexi√≥n OK: ${resultado.count} veh√≠culos obtenidos`, 3000);
                    
                    // Mostrar en consola detalles
                    resultado.data.forEach((vehiculo, index) => {
                        console.log(`  ${index + 1}. ${vehiculo.nombre} - ${vehiculo.marca} - $${vehiculo.precio}`);
                    });
                } else {
                    console.error('‚ùå Test fallido:', resultado.error);
                    UINotifications.error(`Error: ${resultado.error}`, 5000);
                }
            } catch (error) {
                console.error('‚ùå Error en test:', error);
                UINotifications.error(`Error de conexi√≥n: ${error.message}`, 5000);
            }
        }
        
        // Mostrar datos en consola para debug
        async function mostrarDatosConsola() {
            // Esperar un momento para que se cargue todo
            setTimeout(async () => {
                console.log('üìã RESUMEN DEL SISTEMA:');
                console.log('=======================');
                
                // Mostrar configuraci√≥n
                console.log('‚öôÔ∏è  Configuraci√≥n:', {
                    supabaseUrl: CONFIG.supabase.url,
                    tabla: 'vehiculos_arica',
                    endpoint: CONFIG.supabase.endpoints.vehiculos
                });
                
                // Mostrar estad√≠sticas de veh√≠culos
                if (productosManager) {
                    const stats = productosManager.getSummary();
                    console.log('üìä Estad√≠sticas:', stats);
                }
                
                // Mostrar funciones disponibles
                console.log('üîß Funciones Supabase disponibles:');
                console.log('  - window.supabase: Cliente Supabase');
                console.log('  - window.leerTablaVehiculos(consulta, limit)');
                console.log('  - window.analizarVehiculos()');
                console.log('  - window.testSupabaseConnection()');
                console.log('  - Ctrl+Shift+S: Prueba manual');
                
                console.log('========================');
            }, 2000);
        }
        
        // Exponer funciones globales
        window.scrollToSection = scrollToSection;
        window.toggleMobileMenu = toggleMobileMenu;
        window.testSupabaseManual = testSupabaseManual;
        
        // Handler para errores no capturados
        window.addEventListener('error', function(e) {
            console.error('‚ùå Error no capturado:', e.error);
            UINotifications.error('Ocurri√≥ un error inesperado');
        });
        
        // Handler para promesas no capturadas
        window.addEventListener('unhandledrejection', function(e) {
            console.error('‚ùå Promesa no capturada:', e.reason);
            UINotifications.error('Error en operaci√≥n as√≠ncrona');
        });
    </script>
    
    <!-- Analytics (opcional) -->
    <script>
        // Google Analytics
        if (CONFIG.app.analytics.googleAnalyticsId) {
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', CONFIG.app.analytics.googleAnalyticsId);
        }
        
        // Facebook Pixel
        if (CONFIG.app.analytics.facebookPixelId) {
            !function(f,b,e,v,n,t,s)
            {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
            n.callMethod.apply(n,arguments):n.queue.push(arguments)};
            if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
            n.queue=[];t=b.createElement(e);t.async=!0;
            t.src=v;s=b.getElementsByTagName(e)[0];
            s.parentNode.insertBefore(t,s)}(window, document,'script',
            'https://connect.facebook.net/en_US/fbevents.js');
            fbq('init', CONFIG.app.analytics.facebookPixelId);
            fbq('track', 'PageView');
        }
    </script>
</body>
</html>
